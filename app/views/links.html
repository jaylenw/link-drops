<div ng-init="getDumps()">

    <div class = "card">
        <!-- add links here -->
        <form name = "linkForm" class = "center animated fadeIn">
            <br>
            <md-input-container class = "authInputContainer">
            <label>Drop a new link here</label>
            <input type = "url" name = "linkInput" class = "center linkInput" ng-model="enteredLink" ng-paste = "submitLink()">
            </md-input-container>
            <p class = "center linkInstructions">If you enjoy typing links by hand, don't forget to add " http:// " or " https:// " and press "Enter"</p>

            <!--This button is required for form submission -->
            <button type = "submit" style = "display: none" ng-click="submitLink()"></button>

            <div class = "center" ng-show = "!findInput">
                <md-button class="findButton md-raised"
                ng-click = "showFind()">
                Find...
            </md-button>
            </div>

        </form>

        <br ng-show = "!findInput">

        <div  ng-show = "findInput">
            <md-input-container class = "authInputContainer center">
                <label>What are you looking for?</label>
                <input id = "findInput" type = "text"
                class = "center findInput"
                name = "enterFind"
                ng-model="enteredFind">
            </md-input-container>
        </div>

    </div>

    <!-- ng repeat all of our links -->
    <!-- outer div for columns -->
    <div class = "columns animated fadeIn">
        <ul>
            <li
            ng-repeat="dump in dumps track by dump._id"
            ng-show="([dump] | filter:enteredFind).length > 0"
            class = "center card-panel linkCard">

                <!-- This need to be only noembed, and another div should be created under for embedly, followed by various native apis -->
                <!-- Use our Fallbacks (NoEmbed And then Embedly), Display Media Embeds (Bandcamp, Youtube, Vimeo, etc... -->
                <div class = "embed"
                ng-if = "(dump.content.indexOf('https://www.youtube.com/watch?v=') > -1)
                    || (dump.content.indexOf('http://www.amazon.com/') > -1)
                    || (dump.content.indexOf('https://instagram.com/p/') > -1)
                    || (dump.content.indexOf('wikipedia.org/wiki/') > -1)
                    || (dump.content.indexOf('https://vimeo.com/') > -1)
                    || (dump.content.indexOf('https://twitter.com/') > -1 && dump.content.indexOf('/status/') > -1)
                    || (dump.content.indexOf('https://gist.github.com/') > -1)"
                    id = "embed-{{dump.content}}"
                    in-view = "$inview && !dump.lazyEmbed && getEmbed(dump)">
                </div>

                <!-- Image Files -->
                <div class = "embed"
                ng-if = "(dump.content.indexOf('.jpg') > -1)
                    || (dump.content.indexOf('.png') > -1)
                    || (dump.content.indexOf('.gif') > -1)"
                    in-view = "$inview && !dump.lazyEmbed && getImage(dump)">
                    <img id = "img-{{dump.content}}" />
                </div>

                <!-- Soundcloud -->
                <div class = "embed"
                ng-if = "(dump.content.indexOf('https://soundcloud.com/') > -1)"
                    in-view = "$inview && !dump.lazyEmbed && getSoundCloud(dump)">
                    <div class = "noembed-soundcloud">
                        <iframe
                        id = "scWidget-{{dump.content}}"
                        width = "100%" height = "450"
                        frameborder="0" scrolling="no">
                        </iframe>
                    </div>
                </div>

                <!-- KickStarter -->
                <div class = "embed"
                ng-if = "(dump.content.indexOf('https://www.kickstarter.com/projects/') > -1)"
                    in-view = "$inview && !dump.lazyEmbed && getKickStarter(dump)">
                    <iframe
                    id = "kick-{{dump.content}}"
                    class = "kickEmbed"
                    frameborder="0" scrolling="no">
                    </iframe>
                </div>

                <!-- Vine -->
                <div class = "embed"
                ng-if = "(dump.content.indexOf('https://vine.co/v/') > -1)"
                    in-view = "$inview && !dump.lazyEmbed && getVine(dump)">
                    <iframe
                    id = "vine-{{dump.content}}"
                    class = "vineEmbed"
                    frameborder="0" scrolling="no">
                    </iframe>
                </div>

                <!-- Spotify -->
                <div class = "embed"
                ng-if = "(dump.content.indexOf('https://play.spotify.com/') > -1)
                    || (dump.content.indexOf('https://open.spotify.com/') > -1)"
                    in-view = "$inview && !dump.lazyEmbed && getSpotify(dump)">
                    <iframe
                    id = "spotify-{{dump.content}}"
                    class = "spotifyEmbed"
                    frameborder="0" scrolling="no">
                    </iframe>
                </div>

                <!-- Get our favicon and link title -->
                <img ng-src="{{dump.content | favicon}}" alt="Drop Icon" class = "dropFavicon">
                <a id = "linkTitle-{{$index}}"
                href="{{dump.content}}" target="_blank"
                class = "dropURL"
                ng-init = "getTitle(dump, $index)">
                {{dump.content}}
                </a>

                <br>
                <!-- Sharing/Categories -->
                <div class = "grey-text text-lighten-1 linkSubTextLeftContainer">
                    <p ng-repeat="label in dump.labels"
                    class = "linkSubText">
                        <img src="images/x.png"
                        class="linkLabelDelete"
                        ng-click="removeLabel(dump, label)">

                        <a class="linkLabelText"
                        ng-click="filterLabel(label)">{{label.title}}
                        </a>
                    </p>
                    <br />
                    <form>
                        <input class="linkSubTextInput center" type="text"
                        placeholder="New label..."
                        ng-model="dump.newLabel">
                        </input>
                        <button type = "submit" style = "display: none"
                        ng-click="submitLabel(dump)">
                        </button>
                    </form>
                </div>
                <!-- Last updated -->
                <div class = "grey-text text-lighten-1 linkSubTextRightContainer">
                    <p class = "linkSubText" ng-bind="dump.updated_at | date:'h:mm MM/dd/yyyy '"></p>
                    <a class = "grey-text text-lighten-1" ng-click = "removeLink(dump)"><p>Delete Drop</p></a>
                </div>

            </li>
        </ul>
    </div>
</div>
